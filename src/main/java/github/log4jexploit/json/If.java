package github.log4jexploit.json;

import java.util.HashMap;
import java.util.Map;
import java.util.function.Supplier;

public final class If<T> {

    private final Map<Object[], Supplier<T>> functions;
    private Supplier<T> defaultSupplier;


    public If() {
        functions = new HashMap<>();
        defaultSupplier = null;
    }


    public If<T> of(Supplier<T> function, Object... objects) {
        functions.put(objects, function);
        return this;
    }

    public If<T> defaultResult(T value) {
        defaultSupplier = () -> value;
        return this;
    }

    public T resolve(Object... objects) {
        ENTRIES: for (Map.Entry<Object[], Supplier<T>> entry : functions.entrySet()) {
            if(objects.length != entry.getKey().length)
                continue;
            for(int i = 0; i < objects.length; i++) {
                if(!objects[i].equals(entry.getKey()[i])) {
                    continue ENTRIES;
                }
            }

            return entry.getValue().get();
        }

        if (defaultSupplier != null) {
            return defaultSupplier.get();
        }

        return null;
    }
}
