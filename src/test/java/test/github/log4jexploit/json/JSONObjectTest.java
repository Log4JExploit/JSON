package test.github.log4jexploit.json;

import github.log4jexploit.json.JSONArray;
import github.log4jexploit.json.JSONObject;
import org.junit.jupiter.api.Test;

import java.security.spec.RSAOtherPrimeInfo;

import static org.junit.jupiter.api.Assertions.*;

public class JSONObjectTest {

    @Test
    void testToJSONValueEmpty() {
        JSONObject object = new JSONObject();
        object.put("KEY", "");
        assertEquals("{\"KEY\": \"\"}", object.toJSONString());
    }

    @Test
    void testToJSONStringSingle() {
        JSONObject object = new JSONObject();
        object.put("KEY", "VALUE");
        assertEquals("{\"KEY\": \"VALUE\"}", object.toJSONString());
    }

    @Test
    void testToJSONStringEmpty() {
        JSONObject object = new JSONObject();
        assertEquals("{}", object.toJSONString());
    }

    @Test
    void testToJSONStringMultiple() {
        JSONObject object = new JSONObject();
        object.put("Key1", "Value1");
        object.put("Key2", "Value2");
        object.put("Key3", "Value3");
        assertEquals("{\"Key2\": \"Value2\", \"Key1\": \"Value1\", \"Key3\": \"Value3\"}", object.toJSONString());
    }

    @Test
    void testToJSONStringWithNestedObjects() {
        JSONObject object = new JSONObject();
        JSONObject objectNested = new JSONObject();
        objectNested.put("KEY", "VALUE");

        object.put("Key1", 1);
        object.put("Key2", objectNested);
        object.put("Key3", new JSONArray(1, 2, 3));
        assertEquals("{\"Key2\": {\"KEY\": \"VALUE\"}, \"Key1\": 1, \"Key3\": [1, 2, 3]}", object.toJSONString());
    }

    @Test
    void testEscapedText() {
        JSONObject object = new JSONObject();
        object.put("\"Text", "More \" Text");
        assertEquals("{\"\\\"Text\": \"More \\\" Text\"}", object.toJSONString());
    }
}
